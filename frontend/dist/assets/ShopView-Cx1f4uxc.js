import{_ as te,e as c,f as F,c as I,a as v,b as l,w as o,r as i,o as f,d,p as w,n as R,i as oe,q as ae,v as q,E as k}from"./index-QFnM3oiv.js";const ne={class:"shop-management"},ie={class:"card-header"},se={class:"search-bar"},re={key:1},de={class:"pagination"},ue={class:"dialog-footer"},pe={__name:"ShopView",setup(me){const U=c([]),S=c(0),b=c(1),x=c(10),g=c(!1),C=c(!1),y=c(),u=F({item:"",category:"",stop:""}),a=F({id:"",item:"",image:"",description:"",price:0,inputs:"",api:"",category:"默认",stop:!1}),T={item:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{type:"number",min:.01,message:"商品价格不能小于0.01元",trigger:"blur"}],category:[{required:!0,message:"请输入商品分类",trigger:"blur"}]},$=()=>{b.value=1,p()},A=()=>{u.item="",u.category="",u.stop="",b.value=1,p()},M=()=>{C.value=!1,y.value&&y.value.resetFields(),a.id="",a.item="",a.image="",a.description="",a.price=0,a.inputs="",a.api="",a.category="默认",a.stop=!1,g.value=!0},N=n=>{C.value=!0,a.id=n.id,a.item=n.item,a.image=n.image,a.description=n.description,a.price=n.price,a.inputs=n.inputs,a.api=n.api,a.category=n.category,a.stop=n.stop,g.value=!0},z=(n,e)=>{q.confirm(e?"确定要停售这个商品吗？":"确定要上架这个商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{k.success(e?"商品已停售":"商品已上架"),p()}).catch(()=>{})},j=n=>{q.confirm("确定要删除这个商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"danger"}).then(()=>{k.success("删除成功"),p()}).catch(()=>{})},D=async()=>{y.value&&await y.value.validate(n=>{n&&(g.value=!1,k.success(C.value?"编辑成功":"添加成功"),p())})},G=n=>{const e=n.file;a.image=URL.createObjectURL(e)},L=n=>{const e=n.type==="image/jpeg"||n.type==="image/png",s=n.size/1024/1024<2;return e||k.error("上传图片只能是 JPG/PNG 格式!"),s||k.error("上传图片大小不能超过 2MB!"),e&&s},J=n=>{x.value=n,p()},W=n=>{b.value=n,p()},p=()=>{U.value=[],S.value=0};return p(),(n,e)=>{const s=i("el-button"),_=i("el-input"),r=i("el-form-item"),V=i("el-option"),B=i("el-select"),E=i("el-form"),m=i("el-table-column"),P=i("el-image"),O=i("el-tag"),H=i("el-table"),K=i("el-pagination"),Q=i("el-card"),X=i("el-icon"),Y=i("el-upload"),Z=i("el-input-number"),ee=i("el-switch"),le=i("el-dialog");return f(),I("div",ne,[e[24]||(e[24]=v("h2",null,"商店管理",-1)),l(Q,{shadow:"hover"},{header:o(()=>[v("div",ie,[e[15]||(e[15]=v("span",null,"商品列表",-1)),l(s,{type:"primary",onClick:M},{default:o(()=>[...e[14]||(e[14]=[d("添加商品",-1)])]),_:1})])]),default:o(()=>[v("div",se,[l(E,{model:u,inline:""},{default:o(()=>[l(r,{label:"商品名称"},{default:o(()=>[l(_,{modelValue:u.item,"onUpdate:modelValue":e[0]||(e[0]=t=>u.item=t),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"商品分类"},{default:o(()=>[l(B,{modelValue:u.category,"onUpdate:modelValue":e[1]||(e[1]=t=>u.category=t),placeholder:"请选择商品分类"},{default:o(()=>[l(V,{label:"全部",value:""}),l(V,{label:"默认",value:"默认"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"商品状态"},{default:o(()=>[l(B,{modelValue:u.stop,"onUpdate:modelValue":e[2]||(e[2]=t=>u.stop=t),placeholder:"请选择商品状态"},{default:o(()=>[l(V,{label:"全部",value:""}),l(V,{label:"在售",value:!1}),l(V,{label:"停售",value:!0})]),_:1},8,["modelValue"])]),_:1}),l(r,null,{default:o(()=>[l(s,{type:"primary",onClick:$},{default:o(()=>[...e[16]||(e[16]=[d("搜索",-1)])]),_:1}),l(s,{onClick:A},{default:o(()=>[...e[17]||(e[17]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),l(H,{data:U.value,style:{width:"100%"},stripe:""},{default:o(()=>[l(m,{prop:"id",label:"ID",width:"80"}),l(m,{prop:"item",label:"商品名称"}),l(m,{prop:"image",label:"商品图片",width:"100"},{default:o(t=>[t.row.image?(f(),w(P,{key:0,src:t.row.image,"preview-src-list":[t.row.image],style:{width:"50px",height:"50px"},fit:"cover"},null,8,["src","preview-src-list"])):(f(),I("span",re,"无"))]),_:1}),l(m,{prop:"price",label:"商品价格",width:"100"},{default:o(t=>[d(" ¥"+R(t.row.price.toFixed(2)),1)]),_:1}),l(m,{prop:"category",label:"商品分类",width:"120"}),l(m,{prop:"stop",label:"商品状态",width:"100"},{default:o(t=>[l(O,{type:t.row.stop?"danger":"success"},{default:o(()=>[d(R(t.row.stop?"停售":"在售"),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"createdAt",label:"创建时间",width:"180"}),l(m,{label:"操作",width:"200",fixed:"right"},{default:o(t=>[l(s,{type:"primary",size:"small",onClick:h=>N(t.row)},{default:o(()=>[...e[18]||(e[18]=[d("编辑",-1)])]),_:1},8,["onClick"]),t.row.stop?(f(),w(s,{key:1,type:"success",size:"small",onClick:h=>z(t.row.id,!1)},{default:o(()=>[...e[20]||(e[20]=[d("上架",-1)])]),_:1},8,["onClick"])):(f(),w(s,{key:0,type:"warning",size:"small",onClick:h=>z(t.row.id,!0)},{default:o(()=>[...e[19]||(e[19]=[d("停售",-1)])]),_:1},8,["onClick"])),l(s,{type:"danger",size:"small",onClick:h=>j(t.row.id)},{default:o(()=>[...e[21]||(e[21]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),v("div",de,[l(K,{"current-page":b.value,"onUpdate:currentPage":e[3]||(e[3]=t=>b.value=t),"page-size":x.value,"onUpdate:pageSize":e[4]||(e[4]=t=>x.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:S.value,onSizeChange:J,onCurrentChange:W},null,8,["current-page","page-size","total"])])]),_:1}),l(le,{modelValue:g.value,"onUpdate:modelValue":e[13]||(e[13]=t=>g.value=t),title:"{{ isEdit ? '编辑商品' : '添加商品' }}",width:"600px"},{footer:o(()=>[v("span",ue,[l(s,{onClick:e[12]||(e[12]=t=>g.value=!1)},{default:o(()=>[...e[22]||(e[22]=[d("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:D},{default:o(()=>[...e[23]||(e[23]=[d("确定",-1)])]),_:1})])]),default:o(()=>[l(E,{model:a,rules:T,ref_key:"shopFormRef",ref:y,"label-width":"80px"},{default:o(()=>[l(r,{label:"商品名称",prop:"item"},{default:o(()=>[l(_,{modelValue:a.item,"onUpdate:modelValue":e[5]||(e[5]=t=>a.item=t),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"商品图片"},{default:o(()=>[l(Y,{class:"avatar-uploader",action:"#","show-file-list":!1,"http-request":G,"before-upload":L},{default:o(()=>[a.image?(f(),w(P,{key:0,src:a.image,class:"avatar",fit:"cover"},null,8,["src"])):(f(),w(X,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[l(oe(ae))]),_:1}))]),_:1})]),_:1}),l(r,{label:"商品价格",prop:"price"},{default:o(()=>[l(Z,{modelValue:a.price,"onUpdate:modelValue":e[6]||(e[6]=t=>a.price=t),min:.01,step:.01,precision:2,placeholder:"请输入商品价格"},null,8,["modelValue"])]),_:1}),l(r,{label:"商品分类",prop:"category"},{default:o(()=>[l(_,{modelValue:a.category,"onUpdate:modelValue":e[7]||(e[7]=t=>a.category=t),placeholder:"请输入商品分类"},null,8,["modelValue"])]),_:1}),l(r,{label:"商品描述",prop:"description"},{default:o(()=>[l(_,{type:"textarea",modelValue:a.description,"onUpdate:modelValue":e[8]||(e[8]=t=>a.description=t),placeholder:"请输入商品描述",rows:5},null,8,["modelValue"])]),_:1}),l(r,{label:"允许输入字段"},{default:o(()=>[l(_,{type:"textarea",modelValue:a.inputs,"onUpdate:modelValue":e[9]||(e[9]=t=>a.inputs=t),placeholder:"请输入允许用户输入的字段名，多个字段用逗号分隔",rows:3},null,8,["modelValue"])]),_:1}),l(r,{label:"Webhook API"},{default:o(()=>[l(_,{modelValue:a.api,"onUpdate:modelValue":e[10]||(e[10]=t=>a.api=t),placeholder:"请输入Webhook API地址"},null,8,["modelValue"])]),_:1}),l(r,{label:"商品状态"},{default:o(()=>[l(ee,{modelValue:a.stop,"onUpdate:modelValue":e[11]||(e[11]=t=>a.stop=t),"active-text":"停售","inactive-text":"在售"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},fe=te(pe,[["__scopeId","data-v-8299f69a"]]);export{fe as default};
