import{_ as G,e as c,f as L,c as I,a as _,b as a,w as t,r as s,o as u,p as w,d as m,i as P,q as T,v as $,E as f}from"./index-QFnM3oiv.js";const j={class:"app-management"},D={class:"card-header"},J={key:1},O={class:"dialog-footer"},S={__name:"AppView",setup(H){const y=c([]),r=c(!1),g=c(!1),d=c(),l=L({id:"",appName:"",appKey:"",appImage:""}),h={appName:[{required:!0,message:"请输入应用名称",trigger:"blur"}]},x=()=>{g.value=!1,d.value&&d.value.resetFields(),l.id="",l.appName="",l.appKey="",l.appImage="",r.value=!0},N=o=>{g.value=!0,l.id=o.id,l.appName=o.appName,l.appKey=o.appKey,l.appImage=o.appImage,r.value=!0},V=o=>{$.confirm("确定要删除这个应用吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.success("删除成功"),v()}).catch(()=>{})},C=async()=>{d.value&&await d.value.validate(o=>{o&&(r.value=!1,f.success(g.value?"编辑成功":"添加成功"),v())})},A=o=>{const e=o.file;l.appImage=URL.createObjectURL(e)},B=o=>{const e=o.type==="image/jpeg"||o.type==="image/png",n=o.size/1024/1024<2;return e||f.error("上传图片只能是 JPG/PNG 格式!"),n||f.error("上传图片大小不能超过 2MB!"),e&&n},v=()=>{y.value=[]};return v(),(o,e)=>{const n=s("el-button"),i=s("el-table-column"),b=s("el-image"),E=s("el-table"),U=s("el-card"),K=s("el-input"),k=s("el-form-item"),R=s("el-icon"),F=s("el-upload"),M=s("el-form"),q=s("el-dialog");return u(),I("div",j,[e[9]||(e[9]=_("h2",null,"应用管理",-1)),a(U,{shadow:"hover"},{header:t(()=>[_("div",D,[e[4]||(e[4]=_("span",null,"应用列表",-1)),a(n,{type:"primary",onClick:x},{default:t(()=>[...e[3]||(e[3]=[m("添加应用",-1)])]),_:1})])]),default:t(()=>[a(E,{data:y.value,style:{width:"100%"},stripe:""},{default:t(()=>[a(i,{prop:"id",label:"ID",width:"80"}),a(i,{prop:"appName",label:"应用名称"}),a(i,{prop:"appKey",label:"应用密钥",width:"200"}),a(i,{prop:"appImage",label:"应用图片",width:"100"},{default:t(p=>[p.row.appImage?(u(),w(b,{key:0,src:p.row.appImage,"preview-src-list":[p.row.appImage],style:{width:"50px",height:"50px"},fit:"cover"},null,8,["src","preview-src-list"])):(u(),I("span",J,"无"))]),_:1}),a(i,{prop:"createdAt",label:"创建时间",width:"180"}),a(i,{label:"操作",width:"200",fixed:"right"},{default:t(p=>[a(n,{type:"primary",size:"small",onClick:z=>N(p.row)},{default:t(()=>[...e[5]||(e[5]=[m("编辑",-1)])]),_:1},8,["onClick"]),a(n,{type:"danger",size:"small",onClick:z=>V(p.row.id)},{default:t(()=>[...e[6]||(e[6]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(q,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=p=>r.value=p),title:"{{ isEdit ? '编辑应用' : '添加应用' }}",width:"500px"},{footer:t(()=>[_("span",O,[a(n,{onClick:e[1]||(e[1]=p=>r.value=!1)},{default:t(()=>[...e[7]||(e[7]=[m("取消",-1)])]),_:1}),a(n,{type:"primary",onClick:C},{default:t(()=>[...e[8]||(e[8]=[m("确定",-1)])]),_:1})])]),default:t(()=>[a(M,{model:l,rules:h,ref_key:"appFormRef",ref:d,"label-width":"80px"},{default:t(()=>[a(k,{label:"应用名称",prop:"appName"},{default:t(()=>[a(K,{modelValue:l.appName,"onUpdate:modelValue":e[0]||(e[0]=p=>l.appName=p),placeholder:"请输入应用名称"},null,8,["modelValue"])]),_:1}),a(k,{label:"应用图片"},{default:t(()=>[a(F,{class:"avatar-uploader",action:"#","show-file-list":!1,"http-request":A,"before-upload":B},{default:t(()=>[l.appImage?(u(),w(b,{key:0,src:l.appImage,class:"avatar",fit:"cover"},null,8,["src"])):(u(),w(R,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[a(P(T))]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},W=G(S,[["__scopeId","data-v-9369aaaa"]]);export{W as default};
